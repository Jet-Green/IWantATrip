import{h as X,r as c,p as Z,i as ee,m as R,b as f,o as C,c as M,d as e,w as a,B as te,g as d,e as s,f as le,k as oe,F as z,q as A,s as I,t as ae,j as se,l as u,T as Y,v as D,x as ne}from"./index.b2427561.js";import{_ as ie}from"./ImageCropper.308ff051.js";import{_ as ue}from"./UserFullInfo.0646741f.js";import{Q as re}from"./vue-quill.snow.bba8725b.js";import{l as de}from"./ru_RU.2a46c14e.js";import{t as pe}from"./tripType.8920e512.js";const ce=["onSubmit"],fe=d("h2",null,"\u0421\u043E\u0437\u0434\u0430\u0442\u044C \u0442\u0443\u0440",-1),me=u(" \u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 "),_e=u(" \u0424\u043E\u0442\u043E\u0433\u0440\u0430\u0444\u0438\u0438 "),ve={class:"d-flex",style:{"overflow-x":"scroll"}},he=["src","onClick"],ge=d("span",{class:"mdi mdi-12px mdi-plus"},null,-1),ye=u(" \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u043E\u0442\u043E "),xe=u(" \u0414\u0430\u0442\u0430 \u043D\u0430\u0447\u0430\u043B\u0430 "),be=u(" \u0414\u0430\u0442\u0430 \u043A\u043E\u043D\u0446\u0430 "),ke=u(" \u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C "),Ue={style:{"line-height":"40px"}},Se=u(" \u041C\u0430\u043A\u0441. \u0447\u0438\u0441\u043B\u043E \u043B\u044E\u0434\u0435\u0439 "),we=u(" \u0426\u0435\u043D\u044B "),Ce=d("span",{class:"mdi mdi-minus",style:{cursor:"pointer"}},null,-1),Te=d("span",{class:"mdi mdi-12px mdi-plus"},null,-1),Ne=u(" \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0446\u0435\u043D\u044B "),Me=u("\u0422\u0438\u043F \u0442\u0443\u0440\u0430 "),Oe=u("\u041C\u0438\u043D. \u0432\u043E\u0437\u0440\u0430\u0441\u0442, \u043B\u0435\u0442 "),De=u("\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 "),Le=u("\u041F\u0435\u0440\u0438\u043E\u0434 "),Je=u(" \u0420\u0435\u043A\u043B\u0430\u043C\u0430 "),Pe=u(" \u041C\u0430\u0440\u0448\u0440\u0443\u0442 "),Re=u(" \u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B "),$e=u("\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C "),je=d("h3",null,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0444\u043E\u0442\u043E?",-1),Be={class:"d-flex justify-center"},Fe=u("\u0414\u0430 "),Ve={__name:"CreateTripNoHelp",setup(ze){const h=X(),$=["DD.MM.YY","DD.MM.YY"],q=["MM.YY"],L=de,T=c(null);let j="";c(null);const m=c(null),b=c(null),k=c(null),O=c(!1),J=c(null),H=Z();let _=c(!1),N=c([]),U=[],l=ee({name:"",start:null,end:null,maxPeople:null,duration:"",images:[],tripRoute:"",distance:"",cost:[],offer:"",description:m.value,location:"",tripType:"",fromAge:"",period:""}),P=null;const Q=n=>{let t=l.cost.indexOf(n);t!==-1&&l.cost.splice(t,1)},E=()=>{l.cost.push({type:"",price:""})},V=()=>{N.value.splice(J.value,1),U.splice(J.value,1),O.value=!1};function G(){m.value=m.value.split("<p><br></p>").join(""),l.description=m.value;let n={};for(let v in l)n[v]=l[v];let t=n.period.month().toString(),i=t.length==1?"0"+t:t;n.period=i+"."+n.period.year().toString().slice(2),Y.createTrip(l).then(v=>{const p=v.data._id;let S=new FormData;for(let g=0;g<U.length;g++)S.append("trip-image",U[g],p+"_"+g+".png");function w(){H.push("/trips")}Y.uploadTripImages(S).then(g=>{Object.assign(l,{name:"",start:null,end:null,maxPeople:null,duration:"",images:[],tripRoute:"",distance:"",cost:[],offer:"",description:m.value,location:"",tripType:"",fromAge:"",period:""}),P?h.updateUser({email:h.user.email,fullinfo:P,$push:{trips:p}}).then(r=>{h.user=r.data,U=[],N.value=[],T.value.setHTML(""),D.config({duration:3,top:"90vh"}),D.success({content:"\u0422\u0443\u0440 \u0441\u043E\u0437\u0434\u0430\u043D!",onClose:w})}).catch(r=>{console.log(r)}):h.updateUser({email:h.user.email,$push:{trips:p}}).then(r=>{h.user=r.data,U=[],N.value=[],T.value.setHTML(""),D.config({duration:3,top:"90vh"}),D.success({content:"\u0422\u0443\u0440 \u0441\u043E\u0437\u0434\u0430\u043D!",onClose:w})}).catch(r=>{console.log(r)})})})}function K(n){_.value=!1,U.push(n),N.value.push(URL.createObjectURL(n))}function W(n){P=n}return R(m,n=>{j=n,j!==n&&(T.value.setHTML(n),ne(()=>{let t=T.value.getQuill();t.setSelection(n.length,0,"api"),t.focus()}))}),R(b,()=>{let n=Number(JSON.parse(JSON.stringify(k.value)))-Number(JSON.parse(JSON.stringify(b.value)));n>=0?l.duration=Math.round(n/864e5):l.duration="",l.start=b.value.$d.toString()}),R(k,()=>{let n=Date.parse(JSON.parse(JSON.stringify(k.value)))-Date.parse(JSON.parse(JSON.stringify(b.value)));l.duration=Math.round(n/864e5),n>=0?l.duration=Math.round(n/864e5):l.duration="",l.end=k.value.$d.toString()}),(n,t)=>{const i=f("a-col"),v=f("a-input"),p=f("a-button"),S=f("a-date-picker"),w=f("a-input-number"),g=f("a-select"),r=f("a-textarea"),B=f("a-row"),F=f("a-modal");return C(),M("div",null,[e(te),e(B,{type:"flex",justify:"center"},{default:a(()=>[e(i,{xs:22,lg:12},{default:a(()=>[d("form",{action:"POST",onSubmit:se(G,["prevent"])},[e(B,{gutter:[16,16]},{default:a(()=>{var y;return[(y=s(h).user)!=null&&y.fullinfo?oe("",!0):(C(),le(i,{key:0,span:24},{default:a(()=>[e(ue,{onFullInfo:W})]),_:1})),e(i,{span:24},{default:a(()=>[fe,me,e(v,{placeholder:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0442\u0443\u0440\u0430",size:"large",value:s(l).name,"onUpdate:value":t[0]||(t[0]=o=>s(l).name=o)},null,8,["value"])]),_:1}),e(i,{xs:24},{default:a(()=>[_e,d("div",ve,[(C(!0),M(z,null,A(s(N),(o,x)=>(C(),M("img",{key:x,src:o,alt:"",class:"ma-4",style:{"max-width":"200px"},onClick:Ae=>{O.value=!0,J.value=x}},null,8,he))),128))]),e(p,{type:"dashed",block:"",onClick:t[1]||(t[1]=o=>I(_)?_.value=!0:_=!0),class:"ma-8"},{default:a(()=>[ge,ye]),_:1})]),_:1}),e(i,{span:12},{default:a(()=>[xe,e(S,{value:b.value,"onUpdate:value":t[2]||(t[2]=o=>b.value=o),style:{width:"100%"},placeholder:"\u041D\u0430\u0447\u0430\u043B\u043E",locale:s(L),format:$},null,8,["value","locale"])]),_:1}),e(i,{span:12},{default:a(()=>[be,e(S,{value:k.value,"onUpdate:value":t[3]||(t[3]=o=>k.value=o),style:{width:"100%"},placeholder:"\u041A\u043E\u043D\u0435\u0446",locale:s(L),format:$},null,8,["value","locale"])]),_:1}),e(i,{span:12},{default:a(()=>[ke,d("p",Ue,ae(s(l).duration)+" \u0434\u043D.",1)]),_:1}),e(i,{span:12},{default:a(()=>[Se,e(w,{value:s(l).maxPeople,"onUpdate:value":t[4]||(t[4]=o=>s(l).maxPeople=o),style:{width:"100%"},placeholder:"11",min:1},null,8,["value"])]),_:1}),e(i,{span:24},{default:a(()=>[we,(C(!0),M(z,null,A(s(l).cost,o=>(C(),M("div",{key:o.type,style:{display:"flex"},align:"baseline",class:"mb-16"},[e(v,{value:o.first,"onUpdate:value":x=>o.first=x,placeholder:"\u0414\u043B\u044F \u043A\u043E\u0433\u043E"},null,8,["value","onUpdate:value"]),e(w,{value:o.price,"onUpdate:value":x=>o.price=x,style:{width:"100%"},placeholder:"\u0426\u0435\u043D\u0430",min:0,step:.01,class:"ml-16 mr-16"},null,8,["value","onUpdate:value","step"]),e(p,{onClick:x=>Q(o),shape:"circle"},{default:a(()=>[Ce]),_:2},1032,["onClick"])]))),128)),e(p,{type:"dashed",block:"",onClick:E,class:"ma-8"},{default:a(()=>[Te,Ne]),_:1})]),_:1}),e(i,{xs:24,md:12},{default:a(()=>[Me,d("div",null,[e(g,{value:s(l).tripType,"onUpdate:value":t[5]||(t[5]=o=>s(l).tripType=o),style:{width:"100%"},options:s(pe)},null,8,["value","options"])])]),_:1}),e(i,{xs:24,md:12},{default:a(()=>[Oe,e(w,{value:s(l).fromAge,"onUpdate:value":t[6]||(t[6]=o=>s(l).fromAge=o),style:{width:"100%"},placeholder:"10",min:0,max:100},null,8,["value"])]),_:1}),e(i,{xs:24,md:12},{default:a(()=>[De,e(v,{placeholder:"\u0411\u0430\u0439\u043A\u0430\u043B",size:"large",value:s(l).location,"onUpdate:value":t[7]||(t[7]=o=>s(l).location=o)},null,8,["value"])]),_:1}),e(i,{xs:24,md:12},{default:a(()=>[Le,e(S,{value:s(l).period,"onUpdate:value":t[8]||(t[8]=o=>s(l).period=o),style:{width:"100%",height:"40px"},picker:"month",locale:s(L),format:q},null,8,["value","locale"])]),_:1}),e(i,{span:24},{default:a(()=>[Je,e(r,{placeholder:"\u0437\u0430\u0432\u043B\u0435\u043A\u0430\u0442\u0435\u043B\u044C\u043D\u043E\u0435 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u0435",size:"large",value:s(l).offer,"onUpdate:value":t[9]||(t[9]=o=>s(l).offer=o)},null,8,["value"])]),_:1}),e(i,{span:24},{default:a(()=>[Pe,e(r,{placeholder:"\u0413\u043B\u0430\u0437\u043E\u0432-\u041F\u0435\u0440\u043C\u044C 300\u043A\u043C",size:"large",value:s(l).tripRoute,"onUpdate:value":t[10]||(t[10]=o=>s(l).tripRoute=o)},null,8,["value"])]),_:1}),e(i,{span:24,style:{display:"flex","flex-direction":"column"}},{default:a(()=>[Re,e(s(re),{theme:"snow",ref_key:"quill",ref:T,content:m.value,"onUpdate:content":t[11]||(t[11]=o=>m.value=o),contentType:"html",toolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:["#000000","#ff6600","#3daff5"]}],[{align:[]}]]},null,8,["content"])]),_:1}),e(i,{span:24,class:"d-flex justify-center"},{default:a(()=>[e(p,{class:"mt-16",type:"primary",size:"large","html-type":"submit"},{default:a(()=>[$e]),_:1})]),_:1})]}),_:1})],40,ce),e(F,{visible:s(_),"onUpdate:visible":t[12]||(t[12]=y=>I(_)?_.value=y:_=y),footer:null},{default:a(()=>[e(ie,{onAddImage:K})]),_:1},8,["visible"]),e(F,{visible:O.value,"onUpdate:visible":t[13]||(t[13]=y=>O.value=y),footer:null},{default:a(()=>[je,d("div",Be,[e(p,{class:"mt-16",type:"primary",size:"large",onClick:V},{default:a(()=>[Fe]),_:1})])]),_:1},8,["visible"])]),_:1})]),_:1})])}}};export{Ve as default};
